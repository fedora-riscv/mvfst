From 25aea61c75f10c820f7c4b10416986825191651e Mon Sep 17 00:00:00 2001
From: Michel Lind <salimma@fedoraproject.org>
Date: Mon, 11 Sep 2023 21:43:39 -0500
Subject: [PATCH 2/2] Use CMAKE_INSTALL_LIBDIR rather than hardcoding lib

Signed-off-by: Michel Lind <salimma@fedoraproject.org>
---
 quic/CMakeLists.txt                    |  4 ++--
 quic/api/CMakeLists.txt                |  4 ++--
 quic/client/CMakeLists.txt             |  2 +-
 quic/codec/CMakeLists.txt              | 12 ++++++------
 quic/common/CMakeLists.txt             | 14 +++++++-------
 quic/congestion_control/CMakeLists.txt |  2 +-
 quic/dsr/CMakeLists.txt                |  4 ++--
 quic/fizz/client/CMakeLists.txt        |  2 +-
 quic/fizz/handshake/CMakeLists.txt     |  2 +-
 quic/flowcontrol/CMakeLists.txt        |  2 +-
 quic/handshake/CMakeLists.txt          |  2 +-
 quic/happyeyeballs/CMakeLists.txt      |  2 +-
 quic/logging/CMakeLists.txt            |  2 +-
 quic/loss/CMakeLists.txt               |  2 +-
 quic/observer/CMakeLists.txt           |  2 +-
 quic/server/CMakeLists.txt             |  6 +++---
 quic/state/CMakeLists.txt              | 18 +++++++++---------
 17 files changed, 41 insertions(+), 41 deletions(-)

diff --git a/quic/CMakeLists.txt b/quic/CMakeLists.txt
index d89179fc..5d2989b9 100644
--- a/quic/CMakeLists.txt
+++ b/quic/CMakeLists.txt
@@ -33,7 +33,7 @@ install(FILES QuicConstants.h DESTINATION include/quic/)
 install(
   TARGETS mvfst_constants
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_library(
@@ -65,7 +65,7 @@ install(FILES QuicException.h DESTINATION include/quic/)
 install(
   TARGETS mvfst_exception
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 add_subdirectory(api)
 add_subdirectory(client)
diff --git a/quic/api/CMakeLists.txt b/quic/api/CMakeLists.txt
index c7636209..a6bdab61 100644
--- a/quic/api/CMakeLists.txt
+++ b/quic/api/CMakeLists.txt
@@ -139,13 +139,13 @@ endforeach()
 install(
   TARGETS mvfst_transport
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_batch_writer
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/client/CMakeLists.txt b/quic/client/CMakeLists.txt
index 9cb5d16e..91b1c2b7 100644
--- a/quic/client/CMakeLists.txt
+++ b/quic/client/CMakeLists.txt
@@ -66,7 +66,7 @@ endforeach()
 install(
   TARGETS mvfst_client
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/codec/CMakeLists.txt b/quic/codec/CMakeLists.txt
index b555e8a6..2610b0fc 100644
--- a/quic/codec/CMakeLists.txt
+++ b/quic/codec/CMakeLists.txt
@@ -222,37 +222,37 @@ endforeach()
 install(
   TARGETS mvfst_codec_types
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_codec_decode
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_codec_pktbuilder
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_codec_pktrebuilder
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_codec_packet_number_cipher
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_codec
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/common/CMakeLists.txt b/quic/common/CMakeLists.txt
index d532161b..5b694311 100644
--- a/quic/common/CMakeLists.txt
+++ b/quic/common/CMakeLists.txt
@@ -174,43 +174,43 @@ endforeach()
 install(
   TARGETS mvfst_looper
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_buf_accessor
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_bufutil
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_events
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_socketutil
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_transport_knobs
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_async_udp_socket_wrapper
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/congestion_control/CMakeLists.txt b/quic/congestion_control/CMakeLists.txt
index 124ef6f5..86c7836c 100644
--- a/quic/congestion_control/CMakeLists.txt
+++ b/quic/congestion_control/CMakeLists.txt
@@ -66,7 +66,7 @@ endforeach()
 install(
   TARGETS mvfst_cc_algo
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/dsr/CMakeLists.txt b/quic/dsr/CMakeLists.txt
index 7703d9a9..4eabd77f 100644
--- a/quic/dsr/CMakeLists.txt
+++ b/quic/dsr/CMakeLists.txt
@@ -121,13 +121,13 @@ install(
 install(
   TARGETS mvfst_dsr_types
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_dsr_frontend
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/fizz/client/CMakeLists.txt b/quic/fizz/client/CMakeLists.txt
index e6deeed7..885a6f91 100644
--- a/quic/fizz/client/CMakeLists.txt
+++ b/quic/fizz/client/CMakeLists.txt
@@ -47,7 +47,7 @@ endforeach()
 install(
   TARGETS mvfst_fizz_client
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/fizz/handshake/CMakeLists.txt b/quic/fizz/handshake/CMakeLists.txt
index 73e0b3f6..dfb615d2 100644
--- a/quic/fizz/handshake/CMakeLists.txt
+++ b/quic/fizz/handshake/CMakeLists.txt
@@ -53,7 +53,7 @@ endforeach()
 install(
   TARGETS mvfst_fizz_handshake
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/flowcontrol/CMakeLists.txt b/quic/flowcontrol/CMakeLists.txt
index 55fc9eb0..9cb8a983 100644
--- a/quic/flowcontrol/CMakeLists.txt
+++ b/quic/flowcontrol/CMakeLists.txt
@@ -53,7 +53,7 @@ endforeach()
 install(
   TARGETS mvfst_flowcontrol
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/handshake/CMakeLists.txt b/quic/handshake/CMakeLists.txt
index 86092515..09607207 100644
--- a/quic/handshake/CMakeLists.txt
+++ b/quic/handshake/CMakeLists.txt
@@ -53,5 +53,5 @@ endforeach()
 install(
   TARGETS mvfst_handshake
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
diff --git a/quic/happyeyeballs/CMakeLists.txt b/quic/happyeyeballs/CMakeLists.txt
index 09df2a9a..a7f31347 100644
--- a/quic/happyeyeballs/CMakeLists.txt
+++ b/quic/happyeyeballs/CMakeLists.txt
@@ -47,5 +47,5 @@ endforeach()
 install(
   TARGETS mvfst_happyeyeballs
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
diff --git a/quic/logging/CMakeLists.txt b/quic/logging/CMakeLists.txt
index 3a06b216..f3a97cff 100644
--- a/quic/logging/CMakeLists.txt
+++ b/quic/logging/CMakeLists.txt
@@ -50,7 +50,7 @@ endforeach()
 install(
   TARGETS mvfst_qlogger
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/loss/CMakeLists.txt b/quic/loss/CMakeLists.txt
index b8c88c0e..2038db85 100644
--- a/quic/loss/CMakeLists.txt
+++ b/quic/loss/CMakeLists.txt
@@ -57,7 +57,7 @@ endforeach()
 install(
   TARGETS mvfst_loss
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/observer/CMakeLists.txt b/quic/observer/CMakeLists.txt
index 6f9622a0..e42ce2f4 100644
--- a/quic/observer/CMakeLists.txt
+++ b/quic/observer/CMakeLists.txt
@@ -53,5 +53,5 @@ endforeach()
 install(
   TARGETS mvfst_observer
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
diff --git a/quic/server/CMakeLists.txt b/quic/server/CMakeLists.txt
index 391094d1..1f4abb83 100644
--- a/quic/server/CMakeLists.txt
+++ b/quic/server/CMakeLists.txt
@@ -187,19 +187,19 @@ endforeach()
 install(
   TARGETS mvfst_server
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_server_state
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_server_async_tran
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
diff --git a/quic/state/CMakeLists.txt b/quic/state/CMakeLists.txt
index af3578f5..95382462 100644
--- a/quic/state/CMakeLists.txt
+++ b/quic/state/CMakeLists.txt
@@ -328,55 +328,55 @@ endforeach()
 install(
   TARGETS mvfst_state_machine
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_ack_handler
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_datagram_handler
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_stream_functions
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_pacing_functions
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_functions
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_simple_frame_functions
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_state_stream
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 install(
   TARGETS mvfst_transport_settings_functions
   EXPORT mvfst-exports
-  DESTINATION lib
+  DESTINATION ${CMAKE_INSTALL_LIBDIR}
 )
 
 add_subdirectory(test)
-- 
2.41.0

